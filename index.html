<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bybit Trading Mini App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
    }
    .panel {
      background: rgba(255,255,255,0.10);
      border-radius: 18px;
      box-shadow: 0 4px 24px 0 rgba(31,38,135,0.27);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.18);
      padding: 24px 12px 18px 12px;
      width: 100%;
      max-width: 320px; /* Make panel narrower for mobile */
      margin: 0 auto;
      transition: box-shadow 0.3s;
    }
    h2 {
      color: #fff;
      margin-bottom: 14px;
      letter-spacing: 1px;
      font-weight: 700;
      font-size: 1.2em;
      text-shadow: 0 2px 8px #0006;
    }
    .row {
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .label {
      color: #fff;
      font-size: 1em;
      width: 90px;
      text-align: right;
      margin-right: 8px;
      opacity: 0.85;
      text-shadow: 0 1px 2px #0004;
    }
    input, select {
      padding: 7px 8px;
      border-radius: 7px;
      border: 1px solid #222a;
      font-size: 1em;
      background: rgba(255,255,255,0.15);
      color: #fff;
      outline: none;
      width: 120px;
      transition: border 0.2s;
    }
    input:focus, select:focus {
      border: 1.5px solid #00f2fe;
      background: rgba(255,255,255,0.22);
    }
    button {
      width: 100%;
      padding: 12px 0;
      margin-top: 8px;
      border: none;
      border-radius: 10px;
      background: linear-gradient(90deg, #00f2fe 0%, #4facfe 100%);
      color: #fff;
      font-size: 1.05em;
      font-weight: 600;
      letter-spacing: 1px;
      cursor: pointer;
      box-shadow: 0 2px 8px #00f2fe44;
      transition: background 0.2s, transform 0.1s;
      position: relative;
      overflow: hidden;
    }
    button:active {
      transform: scale(0.97);
      background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
    }
    .status {
      margin-top: 14px;
      min-height: 28px;
      color: #fff;
      font-size: 1em;
      text-align: center;
      word-break: break-word;
      text-shadow: 0 1px 2px #0006;
    }
    @media (max-width: 400px) {
      .panel { padding: 10px 2vw; }
      .label { font-size: 0.95em; width: 70px;}
      input, select { width: 80px; font-size: 0.95em;}
    }
  </style>
</head>
<body>
  <div class="panel">
    <h2>Bybit Trading</h2>
    <div class="row">
      <span class="label">Symbol:</span>
      <input id="symbol" placeholder="BTCUSDT" value="BTCUSDT" autocomplete="off" />
    </div>
    <div class="row">
      <span class="label">Side:</span>
      <select id="side">
        <option value="Buy">Buy</option>
        <option value="Sell">Sell</option>
      </select>
    </div>
    <div class="row">
      <span class="label">Type:</span>
      <select id="orderType" onchange="togglePriceInput()">
        <option value="Market">Market</option>
        <option value="Limit">Limit</option>
      </select>
    </div>
    <div class="row">
      <span class="label">Qty:</span>
      <input id="qty" type="number" placeholder="Quantity" min="0.001" step="0.001" autocomplete="off" />
    </div>
    <div class="row" id="priceRow" style="display:none;">
      <span class="label">Price:</span>
      <input id="price" type="number" placeholder="Limit Price" step="0.01" autocomplete="off" />
    </div>
    <button onclick="placeOrder()">Place Order</button>
    <button style="margin-top:8px;" onclick="getPrice()">Get Price</button>
    <div class="status" id="status"></div>
  </div>
  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    function togglePriceInput() {
      const orderType = document.getElementById('orderType').value;
      document.getElementById('priceRow').style.display = orderType === 'Limit' ? '' : 'none';
    }

    function showStatus(msg, error=false) {
      const status = document.getElementById('status');
      status.innerHTML = `<span style="color:${error ? '#ff4e4e':'#00f2fe'}">${msg}</span>`;
    }

    function placeOrder() {
      const symbol = document.getElementById('symbol').value.trim().toUpperCase();
      const side = document.getElementById('side').value;
      const qty = document.getElementById('qty').value;
      const orderType = document.getElementById('orderType').value;
      const price = document.getElementById('price').value;

      if (!symbol.match(/^[A-Z0-9]{3,15}$/)) {
        showStatus('Invalid symbol.', true); return;
      }
      if (!qty || Number(qty) <= 0) {
        showStatus('Enter a valid quantity.', true); return;
      }
      if (orderType === 'Limit' && (!price || Number(price) <= 0)) {
        showStatus('Enter a valid price.', true); return;
      }

      tg.sendData(JSON.stringify({
        action: 'placeOrder',
        symbol,
        side,
        qty,
        orderType,
        price: orderType === 'Limit' ? price : undefined
      }));
      showStatus('Order sent to bot...');
    }

    function getPrice() {
      const symbol = document.getElementById('symbol').value.trim().toUpperCase();
      if (!symbol.match(/^[A-Z0-9]{3,15}$/)) {
        showStatus('Invalid symbol.', true); return;
      }
      tg.sendData(JSON.stringify({
        action: 'getPrice',
        symbol
      }));
      showStatus('Price request sent to bot...');
    }
  </script>
</body>
</html>
